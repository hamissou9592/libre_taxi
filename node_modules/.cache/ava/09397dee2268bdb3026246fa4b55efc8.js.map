{"version":3,"sources":["goa-test.js"],"names":["defaultParams","type","i18n","user","state","locale","origin","action","t","pass","get","sinon","spy","post","truthy","calledWith","falsy","gt","call","data","foo","undefined","plan","length","p","r","is","responses"],"mappings":"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","file":"goa-test.js","sourcesContent":["/*\n    LibreTaxi, free and open source ride sharing platform.\n    Copyright (C) 2016-2017  Roman Pushkin\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Affero General Public License as\n    published by the Free Software Foundation, either version 3 of the\n    License, or (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Affero General Public License for more details.\n\n    You should have received a copy of the GNU Affero General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n/* eslint-disable no-new, no-unused-vars */\nimport test from 'ava';\nimport routes from '../../../../src/routes'; // to aviod circular dependencies\nimport GoaInfo from '../../../../src/actions/decorators/info/goa';\nimport { ss } from '../../../spec-support';\n\nconst defaultParams = { type: 'foo', i18n: {}, user: { state: { locale: 'ru' } } };\n\ntest('can be constructed with default parameters', t => {\n  const origin = {};\n  const action = new GoaInfo(defaultParams, origin);\n  t.pass();\n});\n\ntest('should just call origin on get', t => {\n  const origin = {\n    get: ss.sinon.spy(),\n    post: ss.sinon.spy(),\n  };\n  const action = new GoaInfo(defaultParams, origin);\n  action.get();\n  t.truthy(origin.get.calledWith());\n  t.falsy(origin.post.calledWith());\n});\n\ntest('should just call origin on t, gt with parameters', t => {\n  const origin = {\n    t: ss.sinon.spy(),\n    gt: ss.sinon.spy(),\n  };\n  const action = new GoaInfo(defaultParams, origin);\n  action.t(1, 2, 3);\n  action.gt(11, 22, 33);\n  t.truthy(origin.t.calledWith(1, 2, 3));\n  t.truthy(origin.gt.calledWith(11, 22, 33));\n});\n\ntest('should call \"get\" on \"call\" when no argument provided', t => {\n  const origin = {\n    get: ss.sinon.spy(),\n    post: ss.sinon.spy(),\n  };\n  const action = new GoaInfo(defaultParams, origin);\n  action.call();\n  t.truthy(origin.get.calledWith());\n  t.falsy(origin.post.calledWith());\n});\n\ntest('should call own \"post\" on \"call\" when argument provided', t => {\n  const origin = {\n    get: ss.sinon.spy(),\n    post: ss.sinon.spy(),\n  };\n  const action = new GoaInfo(defaultParams, origin);\n  action.post = ss.sinon.spy();\n  action.call(31337);\n  t.falsy(origin.get.calledWith());\n  t.falsy(origin.post.calledWith());\n  t.truthy(action.post.calledWith(31337));\n});\n\ntest('should call origin on post', t => {\n  const data = [\n    123,\n    'asd',\n    0,\n    -123,\n    [1, 2],\n    { foo: 31337 },\n    '1234.0123, 1234.0123',\n    '123.abc, 123.abc',\n    undefined,\n    '',\n    ['37.012345678901234,-122.012345678901234', '37.012345678901234,-122.012345678901234'],\n    ['37.421955, -122.084058', '37.421955, -122.084058'],\n    [[37.421955, -122.084058], [37.421955, -122.084058]],\n  ];\n  t.plan(data.length * 2);\n\n  for (const p of data) {\n    const origin = {\n      get: ss.sinon.spy(),\n      post: ss.sinon.spy(),\n    };\n    const action = new GoaInfo(defaultParams, origin);\n    action.post(p);\n    t.falsy(origin.get.calledWith());\n    t.truthy(origin.post.calledWith(p));\n  }\n});\n\ntest('should return composite object with if', t => {\n  const origin = {\n    get: ss.sinon.spy(),\n    post: ss.sinon.spy(),\n  };\n  const action = new GoaInfo(defaultParams, origin);\n  const r = action.post(31337);\n  t.is(r.type, 'composite');\n  t.is(r.responses.length, 2);\n  t.is(r.responses[0].type, 'if');\n});\n"]}