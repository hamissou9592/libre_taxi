{"version":3,"sources":["composite-response-handler-test.js"],"names":["h","response","user","t","is","type","pass","api","foo","deepEqual","cb","result","platformType","r1","message","r2","r3","tmp","console","log","arg","add","call","end"],"mappings":";;weAAA;;;;;;;;;;;;;;;;;;AAkBA;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,mBAAK,4CAAL,EAAmD,aAAK;AAAA;;AACtD,MAAMA,IAAI,uCAA6B,EAAEC,UAAU,EAAZ,EAAgBC,MAAM,EAAtB,EAA7B,CAAV;AACAC,IAAEC,EAAF,uBAAK,oCAAEC,IAAP;AAAA;AAAA;AAAA;AAAA,MAAa,4BAAb;AACAF,IAAEG,IAAF;AACD,CAJD;;AAMA,mBAAK,oDAAL,EAA2D,aAAK;AAAA;AAAA;AAAA;;AAC9D,MAAMN,IAAI,uCAA6B,EAAEC,UAAU,EAAZ,EAAgBC,MAAM,EAAtB,EAA0BK,KAAK,EAAEC,KAAK,KAAP,EAA/B,EAA7B,CAAV;AACAL,IAAEC,EAAF,yBAAK,qCAAEC,IAAP;AAAA;AAAA;AAAA;AAAA,MAAa,4BAAb;AACAF,IAAEM,SAAF,yBAAY,qCAAEF,GAAd;AAAA;AAAA;AAAA;AAAA,8BAAmB,EAAEC,KAAK,KAAP,EAAnB;AAAA;AAAA;AAAA;AAAA;AACD,CAJD;;AAMA,cAAKE,EAAL,CAAQ,gCAAR,EAA0C,aAAK;AAC7C,MAAIC,SAAS,EAAb;AACA,MAAMT,OAAO,EAAEU,cAAc,KAAhB,EAAb;AACA,MAAMC,KAAK,2BAAiB,EAAEC,SAAS,KAAX,EAAjB,CAAX;AACA,MAAMC,KAAK,2BAAiB,EAAED,SAAS,KAAX,EAAjB,CAAX;AACA,MAAME,KAAK,2BAAiB,EAAEF,SAAS,OAAX,EAAjB,CAAX;AACA,MAAMG,MAAMC,QAAQC,GAApB;AACAD,UAAQC,GAAR,GAAc,UAACC,GAAD,EAAS;AACrBT,cAAUS,GAAV;AACD,GAFD;;AAIA,MAAMnB,WAAW,kCACdoB,GADc,CACVR,EADU,EAEdQ,GAFc,CAEVN,EAFU,EAGdM,GAHc,CAGVL,EAHU,CAAjB;;AAKA,MAAMhB,IAAI,uCAA6B,EAAEC,kBAAF,EAAYC,UAAZ,EAA7B,CAAV;AACAF,IAAEsB,IAAF,CAAO,YAAM;AAAA;;AACXnB,MAAEC,EAAF,yBAAKO,MAAL;AAAA;AAAA;AAAA;AAAA,QAAa,aAAb;AACAO,YAAQC,GAAR,GAAcF,GAAd;AACAd,MAAEoB,GAAF;AACD,GAJD;AAKD,CAtBD","file":"composite-response-handler-test.js","sourcesContent":["/*\n    LibreTaxi, free and open source ride sharing platform.\n    Copyright (C) 2016-2017  Roman Pushkin\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Affero General Public License as\n    published by the Free Software Foundation, either version 3 of the\n    License, or (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Affero General Public License for more details.\n\n    You should have received a copy of the GNU Affero General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n/* eslint-disable no-new, no-console */\nimport test from 'ava';\nimport CompositeResponseHandler from '../../src/response-handlers/composite-response-handler';\nimport CompositeResponse from '../../src/responses/composite-response';\nimport TextResponse from '../../src/responses/text-response';\n\ntest('can be constructed with default parameters', t => {\n  const h = new CompositeResponseHandler({ response: {}, user: {} });\n  t.is(h.type, 'composite-response-handler');\n  t.pass();\n});\n\ntest('can be constructed with default parameters and api', t => {\n  const h = new CompositeResponseHandler({ response: {}, user: {}, api: { foo: 'bar' } });\n  t.is(h.type, 'composite-response-handler');\n  t.deepEqual(h.api, { foo: 'bar' });\n});\n\ntest.cb('executes all response handlers', t => {\n  let result = '';\n  const user = { platformType: 'cli' };\n  const r1 = new TextResponse({ message: 'one' });\n  const r2 = new TextResponse({ message: 'two' });\n  const r3 = new TextResponse({ message: 'three' });\n  const tmp = console.log;\n  console.log = (arg) => {\n    result += arg;\n  };\n\n  const response = new CompositeResponse()\n    .add(r1)\n    .add(r2)\n    .add(r3);\n\n  const h = new CompositeResponseHandler({ response, user });\n  h.call(() => {\n    t.is(result, 'onetwothree');\n    console.log = tmp;\n    t.end();\n  });\n});\n"]}