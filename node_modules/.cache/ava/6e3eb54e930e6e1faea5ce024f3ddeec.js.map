{"version":3,"sources":["set-price-test.js"],"names":["user","userKey","state","phone","redirectArgs","passengerKey","distance","orderKey","identity","r","i18n","t","is","type","action","response","get","responses","length","message","__","post","route","deepEqual","kicker","menuLocation","currentOrderKey","arg","driverPhone","price","driverIdentity","path"],"mappings":"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","file":"set-price-test.js","sourcesContent":["/*\n    LibreTaxi, free and open source ride sharing platform.\n    Copyright (C) 2016-2017  Roman Pushkin\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Affero General Public License as\n    published by the Free Software Foundation, either version 3 of the\n    License, or (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Affero General Public License for more details.\n\n    You should have received a copy of the GNU Affero General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n/* eslint-disable no-new, no-unused-vars, max-len */\nimport test from 'ava';\nimport routes from '../../../../src/routes'; // to aviod circular dependencies\nimport DriverOrderSetPrice from '../../../../src/actions/menu/driver/order/set-price';\nimport { i18n } from '../../../spec-support';\n\nconst user = {\n  userKey: 'cli_1',\n  state: {\n    phone: '(555) 123-11-22',\n    redirectArgs: {\n      passengerKey: 'cli_2',\n      distance: 5,\n      orderKey: 'd3adb33f',\n    },\n    identity: 31337,\n  },\n};\n\ntest('can be constructed with default parameters', t => {\n  const r = new DriverOrderSetPrice({ i18n, user });\n  t.is(r.type, 'driver-order-set-price');\n});\n\ntest('should return composite response on get', t => {\n  const action = new DriverOrderSetPrice({ i18n, user });\n  const response = action.get();\n  t.is(response.type, 'composite');\n  t.is(response.responses.length, 3);\n  t.is(response.responses[0].type, 'interrupt-prompt');\n  t.is(response.responses[1].type, 'text');\n  t.is(response.responses[1].message, i18n.__('driver-order-set-price.set_price'));\n  t.is(response.responses[2].type, 'request-user-input');\n});\n\ntest('should return composite response on post', t => {\n  const action = new DriverOrderSetPrice({ i18n, user });\n  const response = action.post('100 with some details');\n  t.is(response.type, 'composite');\n  t.is(response.responses[0].type, 'call-action');\n  t.is(response.responses[0].userKey, 'cli_2'); // passenger\n  t.is(response.responses[0].route, 'passenger-contact-driver-price');\n  t.deepEqual(response.responses[0].kicker, {\n    menuLocation: 'order-submitted',\n    currentOrderKey: 'd3adb33f',\n  });\n  t.deepEqual(response.responses[0].arg, {\n    distance: 5,\n    driverPhone: '(555) 123-11-22',\n    price: '100 with some details',\n    driverIdentity: 31337,\n  });\n  t.is(response.responses[1].type, 'text');\n  t.is(response.responses[1].message, 'ðŸ‘Œ OK!');\n  t.is(response.responses[2].type, 'redirect');\n  t.is(response.responses[2].path, 'driver-index');\n});\n"]}